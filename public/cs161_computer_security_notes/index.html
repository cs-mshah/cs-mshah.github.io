<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noodp" /><title>Notes from CS161: Computer Security - Manan Shah</title><meta name="Description" content="This contains my notes from the CS161: Computer Security course from UC Berkeley."><meta property="og:url" content="https://cs-mshah.github.io/cs161_computer_security_notes/">
  <meta property="og:site_name" content="Manan Shah">
  <meta property="og:title" content="Notes from CS161: Computer Security">
  <meta property="og:description" content="This contains my notes from the CS161: Computer Security course from UC Berkeley.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-05-24T18:57:20+05:30">
    <meta property="article:modified_time" content="2023-05-24T18:57:20+05:30">
    <meta property="article:tag" content="Notes">
    <meta property="og:image" content="https://cs-mshah.github.io/android-chrome-192x192.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://cs-mshah.github.io/android-chrome-192x192.png">
  <meta name="twitter:title" content="Notes from CS161: Computer Security">
  <meta name="twitter:description" content="This contains my notes from the CS161: Computer Security course from UC Berkeley.">
      <meta name="twitter:site" content="@cs_mshah">
<meta name="application-name" content="Manan Shah">
<meta name="apple-mobile-web-app-title" content="Manan Shah">

<meta name="theme-color" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><meta name="twitter:creator" content="@cs_mshah" /><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">

<link rel="canonical" href="https://cs-mshah.github.io/cs161_computer_security_notes/" /><link rel="prev" href="https://cs-mshah.github.io/getting_started_with_cp/" /><link rel="next" href="https://cs-mshah.github.io/ncvpripg23_writer_verification/" />
<link rel="stylesheet" href="/css/main.min.css"><link rel="stylesheet" href="/css/style.min.css">
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@200;300;400;600;700;800;900&display=swap"
    rel="stylesheet"><script type="application/ld+json">{"@context": "https://schema.org","@type": "BlogPosting",
        "headline": "Notes from CS161: Computer Security",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://cs-mshah.github.io/cs161_computer_security_notes/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "https://cs-mshah.github.io/images/network-security.jpg",
                            "width":  1024 ,
                            "height":  683 
                        }],"genre": "posts","keywords":["notes"],"wordcount":  5337 ,
        "url": "https://cs-mshah.github.io/cs161_computer_security_notes/","datePublished": "2023-05-24T18:57:20+05:30","dateModified": "2023-05-24T18:57:20+05:30","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "Manan","logo": "https://cs-mshah.github.io/android-chrome-192x192.png"},"author": [{
                        "@type": "Person",
                        "name": "Manan Shah",
                        "url": "https://github.com/cs-mshah"
                    }],"description": "This contains my notes from the CS161: Computer Security course from UC Berkeley."
    }</script></head>


<body data-instant-intensity="viewport" class="tw-flex tw-min-h-screen tw-flex-col"><script type="text/javascript">
    function setTheme(theme) {
      document.body.setAttribute('theme', theme); 
      document.documentElement.className = theme;
      document.documentElement.style.setProperty('color-scheme', theme === 'light' ? 'light' : 'dark');
      if (theme === 'light') {
        document.documentElement.classList.remove('tw-dark')
      } else {
        document.documentElement.classList.add('tw-dark')
      }
      window.theme = theme;   
      window.isDark = window.theme !== 'light' 
    }
    function saveTheme(theme) {window.localStorage && localStorage.setItem('theme', theme);}
    function getMeta(metaName) {const metas = document.getElementsByTagName('meta'); for (let i = 0; i < metas.length; i++) if (metas[i].getAttribute('name') === metaName) return metas[i]; return '';}
    if (window.localStorage && localStorage.getItem('theme')) {
        let theme = localStorage.getItem('theme');
        if (theme === 'light' || theme === 'dark') {
        setTheme(theme);
        } else {
            if ((window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                setTheme('dark');
            } else {
                setTheme('light');
            }
        }
      } else { 
        if ('auto' === 'light' || 'auto' === 'dark') 
            setTheme('auto'), saveTheme('auto'); 
        else saveTheme('auto'), window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light');
    }
    let metaColors = {'light': '#f8f8f8','dark': '#161b22'}
    getMeta('theme-color').content = metaColors[document.body.getAttribute('theme')];
    window.switchThemeEventSet = new Set()
</script><div id="back-to-top"></div>
    <div id="mask"></div><header class="desktop print:!tw-hidden" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Manan Shah"><span class="tw-mr-1"><i class='far fa-edit fa-fw'></i></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item"
                    href="/posts/" > Posts </a><a class="menu-item"
                    href="/tags/" > Tags </a><a class="menu-item"
                    href="/" > About </a><a class="menu-item"
                    href="https://mailchi.mp/26a81bdf8647/personal-blog-sign-up" 
                    rel="noopener noreferrer" target="_blank" ><i class='fa fa-envelope' aria-hidden='true'></i> Newsletter </a><a class="menu-item"
                    href="/index.xml" ><i class='fa fa-rss' aria-hidden='true'></i>  </a><a class="menu-item"
                    href="https://github.com/cs-mshah"  title="GitHub" 
                    rel="noopener noreferrer" target="_blank" ><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                    <input type="text"
                        placeholder="Search titles or contents..."
                        id="search-input-desktop">
                    <button class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                        <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
                    </button>
                    <button class="search-button search-clear" id="search-clear-desktop" title="Clear">
                        <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"/></svg>
                    </button>
                    <span class="search-button search-loading tw-animate-spin" id="search-loading-desktop">
                        <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"/></svg>
                    </span>
                </span><button class="menu-item theme-select" aria-label="Switch Theme">
                    <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M8 256c0 136.966 111.033 248 248 248s248-111.034 248-248S392.966 8 256 8 8 119.033 8 256zm248 184V72c101.705 0 184 82.311 184 184 0 101.705-82.311 184-184 184z"/></svg>
                    <select class="color-theme-select" id="theme-select-desktop" aria-label="Switch Theme">
                        <option value="light">Light</option>
                        <option value="dark">Dark</option>
                        <option value="auto">Auto</option>
                    </select>
                </button></div>
        </div>
    </div>
</header><header class="mobile print:!tw-hidden" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Manan Shah"><span class="tw-mr-1"><i class='far fa-edit fa-fw'></i></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                <div class="search mobile" id="search-mobile">
                    <input type="text"
                        placeholder="Search titles or contents..."
                        id="search-input-mobile">
                    <button class="search-button search-toggle tw-h-10" id="search-toggle-mobile" title="Search">
                        <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
                    </button>
                    <button class="search-button search-clear tw-h-fit" id="search-clear-mobile" title="Clear">
                        <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"/></svg>
                    </button>
                    <span class="search-button search-loading tw-animate-spin" id="search-loading-mobile">
                        <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"/></svg>
                    </span>
                </div>
                <button class="search-cancel" id="search-cancel-mobile">
                    Cancel
                </button>
            </div><a class="menu-item" href="/posts/" title="" >Posts</a><a class="menu-item" href="/tags/" title="" >Tags</a><a class="menu-item" href="/" title="" >About</a><a class="menu-item" href="https://mailchi.mp/26a81bdf8647/personal-blog-sign-up" title="" 
                rel="noopener noreferrer" target="_blank" ><i class='fa fa-envelope' aria-hidden='true'></i>Newsletter</a><a class="menu-item" href="/index.xml" title="" ><i class='fa fa-rss' aria-hidden='true'></i></a><a class="menu-item" href="https://github.com/cs-mshah" title="GitHub" 
                rel="noopener noreferrer" target="_blank" ><i class='fab fa-github fa-fw'></i></a><button class="menu-item theme-select tw-w-full" aria-label="Switch Theme">
                <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M8 256c0 136.966 111.033 248 248 248s248-111.034 248-248S392.966 8 256 8 8 119.033 8 256zm248 184V72c101.705 0 184 82.311 184 184 0 101.705-82.311 184-184 184z"/></svg>
                <select class="color-theme-select" id="theme-select-mobile" aria-label="Switch Theme">
                    <option value="light">Light</option>
                    <option value="dark">Dark</option>
                    <option value="auto">Auto</option>
                </select>
            </button></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div><main class="tw-mx-4 tw-flex-1"><div class="toc print:!tw-hidden" id="toc-auto">
        <h2 class="toc-title">Contents</h2>
        <div class="toc-content always-active" id="toc-content-auto"><nav id="TableOfContents">
  <ul>
    <li><a href="#what-this-post-is-about">What this post is about</a></li>
    <li><a href="#cryptography">Cryptography</a>
      <ul>
        <li><a href="#basics">Basics</a></li>
        <li><a href="#block-ciphers">Block Ciphers</a></li>
        <li><a href="#cryotographic-hashes">Cryotographic Hashes</a></li>
        <li><a href="#message-authentication-codes-macs">Message Authentication Codes (MACs)</a></li>
        <li><a href="#pseudorandom-number-generators">Pseudorandom Number Generators</a></li>
        <li><a href="#diffie-hellman-key-exchange">Diffie-Hellman Key Exchange</a></li>
        <li><a href="#public-key-encryption">Public Key Encryption</a></li>
        <li><a href="#digital-signatures">Digital Signatures</a></li>
        <li><a href="#digital-certificates">Digital certificates</a></li>
        <li><a href="#bitcoin">Bitcoin</a></li>
      </ul>
    </li>
    <li><a href="#network-security">Network Security</a>
      <ul>
        <li><a href="#introduction-to-networking">Introduction to Networking</a></li>
        <li><a href="#arp">ARP</a></li>
        <li><a href="#wpa">WPA</a></li>
        <li><a href="#dhcp">DHCP</a></li>
        <li><a href="#bgp">BGP</a></li>
        <li><a href="#tcp-and-udp">TCP and UDP</a></li>
        <li><a href="#tls">TLS</a></li>
        <li><a href="#dns">DNS</a></li>
        <li><a href="#dnssec">DNSSEC</a></li>
        <li><a href="#dos">DoS</a></li>
        <li><a href="#firewall">Firewall</a></li>
        <li><a href="#ip-security">IP security</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
    </div><dialog id="toc-dialog" class="tw-max-w-full tw-w-full tw-max-h-full tw-h-full tw-ml-16">
        <div class="toc tw-mx-4 tw-max-w-full">
            <h2 class="tw-mx-0 tw-my-6 tw-uppercase tw-text-2xl">Contents</h2>
            <div class="toc-content"><nav id="TableOfContents">
  <ul>
    <li><a href="#what-this-post-is-about">What this post is about</a></li>
    <li><a href="#cryptography">Cryptography</a>
      <ul>
        <li><a href="#basics">Basics</a></li>
        <li><a href="#block-ciphers">Block Ciphers</a></li>
        <li><a href="#cryotographic-hashes">Cryotographic Hashes</a></li>
        <li><a href="#message-authentication-codes-macs">Message Authentication Codes (MACs)</a></li>
        <li><a href="#pseudorandom-number-generators">Pseudorandom Number Generators</a></li>
        <li><a href="#diffie-hellman-key-exchange">Diffie-Hellman Key Exchange</a></li>
        <li><a href="#public-key-encryption">Public Key Encryption</a></li>
        <li><a href="#digital-signatures">Digital Signatures</a></li>
        <li><a href="#digital-certificates">Digital certificates</a></li>
        <li><a href="#bitcoin">Bitcoin</a></li>
      </ul>
    </li>
    <li><a href="#network-security">Network Security</a>
      <ul>
        <li><a href="#introduction-to-networking">Introduction to Networking</a></li>
        <li><a href="#arp">ARP</a></li>
        <li><a href="#wpa">WPA</a></li>
        <li><a href="#dhcp">DHCP</a></li>
        <li><a href="#bgp">BGP</a></li>
        <li><a href="#tcp-and-udp">TCP and UDP</a></li>
        <li><a href="#tls">TLS</a></li>
        <li><a href="#dns">DNS</a></li>
        <li><a href="#dnssec">DNSSEC</a></li>
        <li><a href="#dos">DoS</a></li>
        <li><a href="#firewall">Firewall</a></li>
        <li><a href="#ip-security">IP security</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
        </div>
    </dialog><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC", "true")</script><article class="page single print:!tw-w-full print:!tw-max-w-none print:!tw-m-0 print:!tw-p-0"><h1 class="single-title" data-pagefind-meta="date:24-05-2023" data-pagefind-body>Notes from CS161: Computer Security</h1><div class="post-meta">
            <div class="post-meta-line">
                <span class="post-author"><span class='author'>
        <span class='screen-reader-text'>  </span><a href='https://cs-mshah.github.io/authors/manan/'><img class="tw-inline-block tw-max-h-4 tw-rounded-full tw-translate-y-[-2px] tw-mr-1"  src='/images/avatar.jpg'   alt="Manan Shah avatar" height="16" width="16">Manan Shah</a></span>
                </span></div>
            <div class="post-meta-line"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M148 288h-40c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm108-12v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 96v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm192 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96-260v352c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h48V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h128V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h48c26.5 0 48 21.5 48 48zm-48 346V160H48v298c0 3.3 2.7 6 6 6h340c3.3 0 6-2.7 6-6z"/></svg>&nbsp;<time datetime="24-05-2023">24-05-2023</time>&nbsp;<svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M402.3 344.9l32-32c5-5 13.7-1.5 13.7 5.7V464c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h273.5c7.1 0 10.7 8.6 5.7 13.7l-32 32c-1.5 1.5-3.5 2.3-5.7 2.3H48v352h352V350.5c0-2.1.8-4.1 2.3-5.6zm156.6-201.8L296.3 405.7l-90.4 10c-26.2 2.9-48.5-19.2-45.6-45.6l10-90.4L432.9 17.1c22.9-22.9 59.9-22.9 82.7 0l43.2 43.2c22.9 22.9 22.9 60 .1 82.8zM460.1 174L402 115.9 216.2 301.8l-7.3 65.3 65.3-7.3L460.1 174zm64.8-79.7l-43.2-43.2c-4.1-4.1-10.8-4.1-14.8 0L436 82l58.1 58.1 30.9-30.9c4-4.2 4-10.8-.1-14.9z"/></svg>&nbsp;<time datetime="24-05-2023">24-05-2023</time>&nbsp;<svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3 0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9 0l60.1 60.1c18.8 18.7 18.8 49.1 0 67.9zM284.2 99.8L21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3 0-17l-111-111c-4.8-4.7-12.4-4.7-17.1 0zM124.1 339.9c-5.5-5.5-5.5-14.3 0-19.8l154-154c5.5-5.5 14.3-5.5 19.8 0s5.5 14.3 0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8 0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z"/></svg>&nbsp;5337 words&nbsp;
                    <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm61.8-104.4l-84.9-61.7c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h32c6.6 0 12 5.4 12 12v141.7l66.8 48.6c5.4 3.9 6.5 11.4 2.6 16.8L334.6 349c-3.9 5.3-11.4 6.5-16.8 2.6z"/></svg>&nbsp;24 minutes&nbsp;</div>
        </div><div class="details toc print:!tw-block" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span class="details-icon"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"/></svg></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#what-this-post-is-about">What this post is about</a></li>
    <li><a href="#cryptography">Cryptography</a>
      <ul>
        <li><a href="#basics">Basics</a></li>
        <li><a href="#block-ciphers">Block Ciphers</a></li>
        <li><a href="#cryotographic-hashes">Cryotographic Hashes</a></li>
        <li><a href="#message-authentication-codes-macs">Message Authentication Codes (MACs)</a></li>
        <li><a href="#pseudorandom-number-generators">Pseudorandom Number Generators</a></li>
        <li><a href="#diffie-hellman-key-exchange">Diffie-Hellman Key Exchange</a></li>
        <li><a href="#public-key-encryption">Public Key Encryption</a></li>
        <li><a href="#digital-signatures">Digital Signatures</a></li>
        <li><a href="#digital-certificates">Digital certificates</a></li>
        <li><a href="#bitcoin">Bitcoin</a></li>
      </ul>
    </li>
    <li><a href="#network-security">Network Security</a>
      <ul>
        <li><a href="#introduction-to-networking">Introduction to Networking</a></li>
        <li><a href="#arp">ARP</a></li>
        <li><a href="#wpa">WPA</a></li>
        <li><a href="#dhcp">DHCP</a></li>
        <li><a href="#bgp">BGP</a></li>
        <li><a href="#tcp-and-udp">TCP and UDP</a></li>
        <li><a href="#tls">TLS</a></li>
        <li><a href="#dns">DNS</a></li>
        <li><a href="#dnssec">DNSSEC</a></li>
        <li><a href="#dos">DoS</a></li>
        <li><a href="#firewall">Firewall</a></li>
        <li><a href="#ip-security">IP security</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content" data-pagefind-body><h2 id="what-this-post-is-about" class="headerLink">
    <a href="#what-this-post-is-about" class="header-mark"></a>What this post is about</h2><p><a href="https://textbook.cs161.org/" target="_blank" rel="noopener noreferrer">CS161 | Computer Security</a> is a good introductory course on computer security. It covers basics of <a href="https://textbook.cs161.org/memory-safety/" target="_blank" rel="noopener noreferrer">Memory Safety</a>, <a href="https://textbook.cs161.org/crypto/" target="_blank" rel="noopener noreferrer">Cryptography</a>, <a href="https://textbook.cs161.org/web/" target="_blank" rel="noopener noreferrer">Web Security</a> and <a href="https://textbook.cs161.org/network/" target="_blank" rel="noopener noreferrer">Network Security</a>. Their textbook was one of the reference books for an introductory computer security course that I had taken in college under <a href="https://drravimittal.github.io/" target="_blank" rel="noopener noreferrer">Dr. Ravi Mittal</a>.</p>
<p>I just thought of posting some notes that I had made from the textbook while reading from some of the sections. I think these might be useful for people who want to get the key points at a glance, although I would <em>highly recommend</em> reading the textbook, which in itself is crisp.</p>
<p>You can directly jump to any section from the table of contents. Here you go!</p>
<h2 id="cryptography" class="headerLink">
    <a href="#cryptography" class="header-mark"></a>Cryptography</h2><h3 id="basics" class="headerLink">
    <a href="#basics" class="header-mark"></a>Basics</h3><ul>
<li><strong>Kerckhoff’s Principle</strong> is a security principle which states that cryptosystems should remain <em>secure even when the attacker knows all the internal details</em> of the system, except the key.</li>
<li><strong>Shannon&rsquo;s maxim</strong> is a security principle wherein the <em>enemy knows the system</em>, meaning that you should assume that the attacker knows every detail about the system you are working with. (Don’t rely on security through obscurity)</li>
<li><strong>Actors</strong>
<ul>
<li>Alice and Bob: The main characters trying to send messages to each other over an insecure communication channel.
<ul>
<li>Carol and Dave can also join the party later</li>
</ul>
</li>
<li><strong>Eve</strong>: An eavesdropper who <em>can read any data sent over the channel</em> (an honest-but-curious attacker).</li>
<li><strong>Mallory</strong>: A manipulator who <em>can read and modify any data</em> sent over the channel (a malicious attacker).</li>
</ul>
</li>
<li><strong>CIA model</strong>
<ul>
<li><strong>Confidentiality</strong> is a goal of cryptography wherein the adversary cannot read our messages. Essentially, the ciphertext should not give the attacker any additional information about the plaintext.
<ul>
<li>experiment: Alice has encrypted and sent one of two messages, either $M_0$ or $M_1$, and the attacker, Eve, has no idea which was sent. Eve tries to guess which was sent by looking at the ciphertext. If the encryption scheme is confidential, then Eve’s probability of guessing which message was sent should be $1/2$.</li>
<li>This experiment can be applied to different threat models.</li>
</ul>
</li>
<li><strong>Integrity</strong> is a goal of cryptography wherein the adversary cannot change any messages without being detected.</li>
<li><strong>Authenticity</strong> is a goal of cryptography wherein one can prove that a message came from the person who claims to have written it.</li>
</ul>
</li>
<li><strong>Symmetric and Asymmetric-Key Cryptography</strong></li>
</ul>

<div class="table-wrapper">
  <table>
    <thead>
        <tr>
            <th style="text-align: left">property</th>
            <th style="text-align: left">Symmetric-key</th>
            <th style="text-align: left">Asymmetric-key</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="text-align: left">Confidentiality</td>
            <td style="text-align: left">Block ciphers with chaining modes (e.g., AES-CBC)</td>
            <td style="text-align: left">Public-key encryption(e.g., El Gamal, RSA encryption)</td>
        </tr>
        <tr>
            <td style="text-align: left">Integrity and authentication</td>
            <td style="text-align: left">MACs (e.g., AES-CBC-MAC)</td>
            <td style="text-align: left">Digital signatures (e.g., RSA signatures). Alice computes a digital signature of her message using her private key, and appends the signature to her message. When Bob receives the message and its signature, he will be able to use Alice’s public key</td>
        </tr>
        <tr>
            <td style="text-align: left">Scheme overview</td>
            <td style="text-align: left">Alice uses her secret key to encrypt a message, and Bob uses the same secret key to decrypt the message</td>
            <td style="text-align: left">Alice can encrypt her message under Bob&rsquo;s public key and Bob will be able to decrypt using his private key.</td>
        </tr>
    </tbody>
  </table>
</div>
<ul>
<li>
<p><strong>Threat models</strong></p>
<ul>
<li>column 2: can eve trick <em>Alice</em> <img class="tw-inline" loading="lazy" src='https://i.imgur.com/gvqiMkv.png'     ></li>
<li>highlight - focus of this course.</li>
<li>encryption algorithms provide security against chosen-plaintext/ciphertext attacks, both because those attacks are practical in some settings, and because it is in fact feasible to provide good security even against this very powerful attack model.</li>
<li>replay-attack: eve can send Bob a repeated encrypted message from Alice.</li>
</ul>
</li>
<li>
<p><strong>IND-CPA secure</strong> (indistinguishability under chosen plaintext attack): even if Eve can trick Alice into encrypting some messages, she still cannot distinguish whether Alice sent $M_0$ or $M_1$ with probability greater than half.</p>
<ul>
<li>if a scheme leaks the plaintext length, it can still be considered IND-CPA secure. (because not leaking length information is impractical)</li>
<li>Eve is limited to a practical number of encryption requests.
<ul>
<li>any algorithm Eve uses during the game must run in $O(n^k)$ time, for some constant $k$.</li>
</ul>
</li>
<li>Eve only wins if she has a non-negligible advantage.</li>
<li>Only <em>non-deterministic schemes are IND-CPA secure</em> as nothing is preventing Eve from asking Alice again.</li>
</ul>
</li>
<li>
<p><strong>One-time pad</strong></p>
<ul>
<li>Key generation: Alice and Bob pick a shared random key $K$.</li>
<li>Encryption $C=M\oplus{K}$</li>
<li>Decryption $M=C\oplus{K}$</li>
<li>IND-CPA secure</li>
<li>The shared key cannot be reused to transmit another message M′, making this infeasible for practical purposes as new keys need to be generated every time.</li>
</ul>
</li>
</ul>
<h3 id="block-ciphers" class="headerLink">
    <a href="#block-ciphers" class="header-mark"></a>Block Ciphers</h3><ul>
<li>A block cipher transforms a fixed-length, $n$-bit input into a fixed-length $n$-bit output.</li>
<li>Encryption function $E:\{0,1\}^k \times \{0,1\}^n \rightarrow \{0,1\}^n$ is a permutation of the $n$-bit input string, given some fixed $k$-bit key. This function is invertible and bijective as it should allow decryption.</li>
<li>Most common: AES (Advanced Encryption Standard). ($n$ = 128, $k$ = 128). AES is computationally indistinguishable from random. (no proof. but believed to be)</li>
<li>Block ciphers alone are not IND-CPA secure as they are deterministic.
<ul>
<li>To solve this randomization is needed.</li>
</ul>
</li>
</ul>

<div class="table-wrapper">
  <table>
    <thead>
        <tr>
            <th style="text-align: left">Mode</th>
            <th style="text-align: left">Encryption</th>
            <th style="text-align: left">Decryption</th>
            <th style="text-align: left">Parallelizable</th>
            <th style="text-align: left">IND-CPA secure</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="text-align: left">ECB (electronic code book)</td>
            <td style="text-align: left">$C_i=E_K(M_i)$</td>
            <td style="text-align: left">$M_i=D_K(C_i)$</td>
            <td style="text-align: left">Both Encryption and Decrytion</td>
            <td style="text-align: left">No</td>
        </tr>
        <tr>
            <td style="text-align: left">CBC (cipher block chaining)</td>
            <td style="text-align: left">$\begin{cases} C_0 = IV \cr C_i = E_K(P_i \oplus C_{i-1}) \end{cases}$</td>
            <td style="text-align: left">$P_i = D_K(C_i) \oplus C_{i-1}$</td>
            <td style="text-align: left">Only Decryption</td>
            <td style="text-align: left">Yes</td>
        </tr>
        <tr>
            <td style="text-align: left">CFB (ciphertext feedback)</td>
            <td style="text-align: left">$\begin{cases} C_0 = IV \cr C_i = E_K(C_{i-1}) \oplus P_i \end{cases}$</td>
            <td style="text-align: left">$P_i = E_K(C_{i-1}) \oplus C_i$</td>
            <td style="text-align: left">Only Decryption</td>
            <td style="text-align: left">Yes</td>
        </tr>
        <tr>
            <td style="text-align: left">OFB (output feedback)</td>
            <td style="text-align: left">$\begin{cases} Z_0 = IV \cr Z_i = E_K(Z_{i-1}) \cr C_i = M_i \oplus Z_i \end{cases}$</td>
            <td style="text-align: left">$P_i = C_i \oplus Z_i$</td>
            <td style="text-align: left">Only Decryption</td>
            <td style="text-align: left">Yes</td>
        </tr>
        <tr>
            <td style="text-align: left">CTR (counter)</td>
            <td style="text-align: left">$C_i = E_K(IV + i) \oplus M_i$</td>
            <td style="text-align: left">$M_i = E_K(IV + i) \oplus C_i$</td>
            <td style="text-align: left">Both Encryption and Decryption</td>
            <td style="text-align: left">Yes. $IV$ loss catastrophic</td>
        </tr>
    </tbody>
  </table>
</div>
<ul>
<li><strong>ECB(electronic code book) mode</strong>
<ul>
<li>plaintext $M$ is simply broken into $n$-bit blocks $M_1 \dots M_l$,</li>
<li>Encryption: $C_i=E_K(M_i)$</li>
<li>Decryption $M_i=D_K(C_i)$</li>
<li>flawed as it leaks information. (if $M_i=M_j$ then $C_i=C_j$) <img class="tw-inline" loading="lazy" src='https://textbook.cs161.org/assets/images/crypto/symmetric/ECB_decryption.png'     ></li>
</ul>
</li>
<li><strong>CBC(cipher block chaining) mode</strong>
<ul>
<li>$IV$ : random $n$-bit string called initialization vector, new for every message (to be used only <strong>once</strong>), public. (also called <em>nonce - number used once</em>)</li>
<li>Encryption: $\begin{cases} C_0 = IV \cr C_i = E_K(P_i \oplus C_{i-1}) \end{cases}$ (<strong>Cannot</strong> be parallelized)</li>
<li>Decryption: $P_i = D_K(C_i) \oplus C_{i-1}$ (<strong>Can</strong> be parallelized) <img class="tw-inline" loading="lazy" src='https://textbook.cs161.org/assets/images/crypto/symmetric/CBC_encryption.png'   alt="image#invert"  ></li>
<li>strong security guarantees</li>
</ul>
</li>
<li><strong>CFB Mode (Ciphertext Feedback Mode)</strong>
<ul>
<li>Encryption: $\begin{cases} C_0 = IV \cr C_i = E_K(C_{i-1}) \oplus P_i \end{cases}$</li>
<li>Decryption: $P_i = E_K(C_{i-1}) \oplus C_i$ <img class="tw-inline" loading="lazy" src='https://textbook.cs161.org/assets/images/crypto/symmetric/CFB_encryption.png'     ></li>
</ul>
</li>
<li><strong>OFB Mode (Output Feedback Mode)</strong>
<ul>
<li>Encryption: $\begin{cases} Z_0 = IV \cr Z_i = E_K(Z_{i-1}) \cr C_i = M_i \oplus Z_i \end{cases}$</li>
<li>Decryption: $P_i = C_i \oplus Z_i$</li>
</ul>
</li>
<li><strong>Counter (CTR) Mode</strong>
<ul>
<li>Encryption: $C_i = E_K(IV + i) \oplus M_i$</li>
<li>Decryption: $M_i = E_K(IV + i) \oplus C_i$</li>
</ul>
</li>
<li>Note that all the above schemes can be tampered by simply swapping different ciphertext blocks, thus providing <strong>C</strong>onfidentiality but not <strong>I</strong>ntegrity and <strong>A</strong>uthenticity.</li>
<li><strong>Padding</strong>
<ul>
<li>Used when message isn&rsquo;t multiple of block size.</li>
<li>Padding scheme <code>PKCS#7</code>: pad the message by the number of padding bytes used.</li>
<li>Used in CBC (cipher block chaining) mode but not in CTR (counter) mode. See the decryption function to decide.</li>
</ul>
</li>
</ul>
<h3 id="cryotographic-hashes" class="headerLink">
    <a href="#cryotographic-hashes" class="header-mark"></a>Cryotographic Hashes</h3><ul>
<li><strong>One Way</strong>: $y=H(x)$. Not possible to find $x$ s.t $H(x)=y$ for a given $y$.</li>
<li><strong>Second preimage resistant</strong>: infeasible to find another input $x&rsquo;$ such that $x&rsquo; \neq x$ but $H(x)=H(x&rsquo;)$.</li>
<li><strong>Collision resistant</strong>: infeasible to find <em>any</em> pair of messages $x,x&rsquo;$ such that $x \neq x&rsquo;$ but $H(x)=H(x&rsquo;)$. (practically infeasible)</li>
<li><strong>Example use case</strong>: If publicised hash is authentic, then we can compare the publicised hash with the downloaded software/file&rsquo;s hash to check if it hasn&rsquo;t been tampered with.</li>
<li><strong>Algorithms</strong>
<ul>
<li>MD5, SHA-1: broken</li>
<li>SHA-2 (vulnerable to length extension attack), SHA-3: in use</li>
<li>selection: relate output length to corresponding symmetric key algorithm. For AES-128, use SHA-256 or SHA-384, making cracking equally difficult</li>
</ul>
</li>
</ul>
<h3 id="message-authentication-codes-macs" class="headerLink">
    <a href="#message-authentication-codes-macs" class="header-mark"></a>Message Authentication Codes (MACs)</h3><ul>
<li>The MAC on a message $M$  is a value $F(K,M)$ computed from $K$ and $M$; the value $F(K,M)$ is called the <em>tag</em> for $M$ or the MAC of $M$. Typically, we might use a 128-bit key $K$ and 128-bit tags.</li>
<li>While sending a message send $\langle M,T \rangle$.</li>
<li>To check integrity and authenticity, compute the MAC of the message part and compare with the Tag.</li>
<li>Deterministic as it is used for comparing.</li>
<li><strong>Does not guarantee confidentiality. Only Authenticity and Integrity</strong></li>
<li>No eve should be able to generate valid MAC for unseen messages.</li>
<li>MACs provide security against chosen-plaintext/ciphertext attacks.</li>
<li><strong>AES-EMAC</strong>
<ul>
<li>$K=\langle K_1, K_2 \rangle$</li>
<li>$M = P_1 \Vert P_2 \Vert &hellip; \Vert P_n$</li>
<li>$S_0=0$, $S_i=AES_{K_1}(S*i-1 \oplus P_i)$</li>
<li>$T=AES_{K_2}(S_n)$</li>
<li>provably secure assuming AES is secure.</li>
</ul>
</li>
<li><strong>HMAC (Hash Message Authentication Code)</strong>
<ul>
<li>when using with a block cipher, choose an HMAC whose output is $2 \times key$ length used for the associated block cipher.</li>
<li>output of HMAC is the same number of bits as the underlying hash function</li>
<li>$\text{NMAC}(K_1, K_2, M) = H(K_1 \Vert H(K_2 \Vert M))$</li>
<li>HMAC (uses only 1 key) is a more specific version of NMAC</li>
</ul>
</li>
<li><strong>Authenticated encryption</strong>
<ul>
<li><em>encrypt-then-MAC</em>
<ul>
<li>$\langle \mathsf{Enc}_{K_1}(M), \mathsf{MAC}_{K_2}(\mathsf{Enc}_{K_1}(M))\rangle$</li>
<li>better approach.</li>
</ul>
</li>
<li><em>MAC-then-encrypt approach</em>
<ul>
<li>$\mathsf{Enc}_{K_1}(M \Vert \mathsf{MAC}_{K_2}(M))$</li>
<li>only detect if the message is tampered after we decrypt it.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="pseudorandom-number-generators" class="headerLink">
    <a href="#pseudorandom-number-generators" class="header-mark"></a>Pseudorandom Number Generators</h3><ul>
<li><em>Seed(entropy)</em>: Take in some initial truly random entropy and initialize the pRNGs internal state.</li>
<li><em>Reseed(entropy)</em>: Take in some additional truly random entropy, updating the pRNGs internal state as needed.</li>
<li><em>Generate(n)</em>: Generate $n$ pseudorandom bits, updating the internal state as needed. Some pRNGs also support adding additional entropy directly during this step.</li>
<li><em>rollback resistance</em>: previously-generated output of the pRNG should still be computationally indistinguishable from random, even if the attacker knows the current internal state of the pRNG.</li>
<li><strong>HMAC-DRBG</strong>
<ul>
<li>computes HMAC on the previous block of pRNG output. repeats.</li>
<li>internal state: $K$ and $V$ (message part of HMAC). update after generation of $n$ bits.</li>
<li>Additional true randomness can also be provided.</li>
</ul>
</li>
<li><strong>Stream-Cipher</strong>
<ul>
<li>encrypt a stream of bytes coming (Ex. movie)</li>
<li>Use one time pad for encryption and decryption of every bit.</li>
<li>bits generated using pRNG</li>
<li>Secret key is used to seed the pRNG</li>
<li>use an additional $IV$ to seed.</li>
<li>Encryption: $Enc(K, M) = \langle IV, PRNG(K, IV) \oplus M \rangle$</li>
<li>Decryption: $Dec(K, IV, C_2) = PRNG(K, IV) \oplus C_2$</li>
<li>Use of counter in stream cipher: ability to encrypt or decrypt an arbitrary point in the message without starting from the beginning</li>
</ul>
</li>
</ul>
<h3 id="diffie-hellman-key-exchange" class="headerLink">
    <a href="#diffie-hellman-key-exchange" class="header-mark"></a>Diffie-Hellman Key Exchange</h3><ul>
<li>Remember the paint exchange analogy. One public paint colour is known. Alice and Bob exchange public paint mixed with their own secret colours and then add their own colour to the received mix to generate the common secret key.</li>
<li><strong>One way function</strong>
<ul>
<li>$f$ s.t given $x$, it is easy to compute $f(x)$, but given $y$, it is practically impossible to find a value $x$ s.t $f(x)=y$</li>
<li>Ex. $f(x) = g^x \bmod p$. ($p$ is a large prime and $1&lt;g&lt;p-1$)</li>
<li><em>discrete logarithm problem</em>: computationally hard to solve</li>
</ul>
</li>
<li>$g$, $p$ are fixed and public</li>
<li>$A = g^a \bmod p$</li>
<li>$B = g^b \bmod p$. ($a$, $b$ $\in {0,1,\dots,p-2}$)</li>
<li>$S = B^a = A^b = g^{ab} = g^{ba} \bmod p$. $S$ is the shared secret.</li>
<li>Elliptic curve Diffie-Hellman: smaller keys with same security</li>
<li>Protocol only resistant against Eve but not Mallory.
<img class="tw-inline" loading="lazy" src='https://textbook.cs161.org/assets/images/crypto/key-exchange/diffie_mitm.png'   alt="Diagram of the Diffie Hellman key exchange between Alice and Bob with Mallory in the middle"  ></li>
<li>Happens due to lack of integrity and authenticity.</li>
</ul>
<h3 id="public-key-encryption" class="headerLink">
    <a href="#public-key-encryption" class="header-mark"></a>Public Key Encryption</h3><ul>
<li>Public-key cryptography provides a nice way to help with the key management problem. Alice can pick a secret key $K$ for some symmetric-key cryptosystem, then encrypt $K$ under Bob’s public key and send Bob the resulting ciphertext. Bob can decrypt using his private key and recover $K$. Then Alice and Bob can communicate using a symmetric-key cryptosystem, with $K$ as their shared key, from there on.</li>
<li><strong>trapdoor one-way function</strong>: same as a one-way function, but given $y$ and a special backdoor $K$, it is easy to find an $x$ s.t $f(x)=y$.
<ul>
<li>given a private key $PK$ and a ciphertext $y$, it is easy for find $x=f^{-1}(y)$.</li>
</ul>
</li>
<li><strong>El Gamal encryption</strong>:
<ul>
<li><em>System parameters:</em> a 2048-bit prime $p$, and a value $g$ in the range $2 \ \dots p − 2$. Both are arbitrary, fixed, and public.</li>
<li><em>Key generation:</em> Bob picks $b$ in the range $0 \dots p − 2$ randomly, and computes $B = g^b \bmod p$. His public key is $B$ and his private key is $b$.</li>
<li><em>Encryption:</em> $E_B(m) = (g^r \bmod p, m \times B^r \bmod p)$ where $r$ (Alice&rsquo;s private key) is chosen randomly from $0 \dots p − 2$, let $R = g^r \bmod p$.</li>
<li><em>Decryption:</em> $D_b(R,S) = R^{−b} \times S \bmod p$.</li>
</ul>
</li>
<li><strong>RSA encryption</strong>:
<ul>
<li><em>Key generation:</em>
<ul>
<li>$p, q$ random 2 large primes.</li>
<li>$N=pq$</li>
<li>let $e$ (usually 3, 17, 65, 537) be such that $gcd(e, (p - 1)(q - 1)) = 1$</li>
<li>Public Key: $(N, e)$</li>
<li>Private Key: $d = e^{-1} \bmod (p-1)(q-1)$</li>
</ul>
</li>
<li><em>Enc(e, N, M):</em> $C = M^e \bmod N$</li>
<li><em>Dec(d, C):</em> $C^d \bmod N$.</li>
</ul>
</li>
<li>RSA isn&rsquo;t IND-CPA secure (because deterministic).
<ul>
<li>to counter this, OAEP (Optimal Asymmetric Encryption Padding) is used.</li>
</ul>
</li>
<li>RSA uses two variables during encryption while El Gamal uses three variables</li>
<li>Public key cryptography relies on the fact that the published public key <em>really</em> belongs to the person it is supposed to. Is the public key integrity maintained?</li>
<li><strong>Session keys</strong>: because public key cryptography is computationally expensive, we use it to distribute session keys. These keys are symmetric keys used for various purposes - encrypting messages and in MACs.</li>
</ul>
<h3 id="digital-signatures" class="headerLink">
    <a href="#digital-signatures" class="header-mark"></a>Digital Signatures</h3><ul>
<li>Needed for non repudiation
<ul>
<li>In case of symmetric keys, we cannot prove who generated the message.</li>
</ul>
</li>
<li>Asymmetric algorithms</li>
<li>On its own doesn&rsquo;t provide confidentiality</li>
<li>Use private key while signing</li>
<li><em>Key generation</em>: There is a randomized algorithm $KeyGen$ that outputs a matching public key and private key: $(PK,SK) = KeyGen()$ . Each invocation of $KeyGen$ produces a new keypair.</li>
<li><em>Signing</em>: There is a signing algorithm Sign: $S = Sign(SK,M)$ is the signature on the message $M$ (with private key $SK$).</li>
<li><em>Verification</em>: There is a verification algorithm $Verify$, where $Verify(PK,M,S)$ returns true if $S$ is a valid signature on $M$ (with public key $PK$) or false if not.</li>
<li>RSA Signatures: $H(M) = F_U(S)$. $S$ is the signature, $H$ is the hash function. $F$ is a trapdoor one-way function, $U$ - public key.
<ul>
<li>The signer computes $S = F^{-1}(H(M))$ as he has the private key $K$</li>
<li>Because $H$ is one way and $F$&rsquo;s trapdoor is not known to the attacker, the message cannot be decrypted by an attacker.</li>
<li>Hash allows signing large messages.</li>
</ul>
</li>
<li>digital envelop
<ul>
<li>message + signature is visible. used for confidentiality. uses symmetric keys too.</li>
</ul>
</li>
</ul>
<h3 id="digital-certificates" class="headerLink">
    <a href="#digital-certificates" class="header-mark"></a>Digital certificates</h3><ul>
<li>how do we know that the public key is authentic as claimed by the person?
<ul>
<li>MITM attack on public keys</li>
</ul>
</li>
<li><em>Digital certificates</em> are a way to represent an alleged association between a person’s name and their public key, as attested by some certifying party.</li>
<li>The certifying party signs a message with the name and public key of the person with its own private key.</li>
<li>For Alice to communicate with Bob, she needs to trust the certifying authority and have its trusted correct public key to decrypt the message and obtain Bob&rsquo;s public key.</li>
<li>The public key of the trusted CA can be hardcoded in applications that need to use cryptography.</li>
<li>Web browsers come configured with a list of many trusted CAs.</li>
<li><em>certificate chain</em>: a sequence of certificates, each of which authenticates the public key of the party who has signed the next certificate in the chain.</li>
<li><em>Revocation</em>: CA can issue certificates with <em>validity periods</em> and additionally list invalid certificates through <em>revocation lists</em>.
<ul>
<li>Risk: DoS attack on the revocation list servers.</li>
</ul>
</li>
<li>roughly 150 root CAs</li>
</ul>
<h3 id="bitcoin" class="headerLink">
    <a href="#bitcoin" class="header-mark"></a>Bitcoin</h3><ul>
<li>The goal of Bitcoin is to replicate these basic properties of a <em>functioning currency system</em>, but <em>without any centralized party</em>. Instead of relying on a trusted entity, Bitcoin <em>uses cryptography</em> to enforce the basic properties of currency.</li>
<li>Identity: Public key of a user.</li>
<li>Messages:
<ul>
<li>$PK_A$ sends $n$ units of currency to $PK_B$</li>
<li>anyone can confirm this</li>
</ul>
</li>
<li>Balances
<ul>
<li>Trusted ledger
<ul>
<li>A ledger is a written record that everybody can view</li>
<li>append only, immutable</li>
<li>distributed</li>
</ul>
</li>
</ul>
</li>
<li>Hash chains
<ul>
<li>if you get the hash of the latest block from a trusted source, then you can verify that all of the previous history is correct</li>
</ul>
</li>
</ul>

<div class="table-wrapper">
  <table>
    <thead>
        <tr>
            <th style="text-align: ">Block 1</th>
            <th style="text-align: ">Block 2</th>
            <th style="text-align: ">Block 3</th>
            <th style="text-align: ">Block 4</th>
            <th style="text-align: ">Block 5</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="text-align: ">$m_1$</td>
            <td style="text-align: ">$m_2, H(\text{Block}_1)$</td>
            <td style="text-align: ">$m_3, H(\text{Block}_2)$</td>
            <td style="text-align: ">$m_4, H(\text{Block}_3)$</td>
            <td style="text-align: ">$m_5, H(\text{Block}_4)$</td>
        </tr>
    </tbody>
  </table>
</div>
<ul>
<li>consensus
<ul>
<li>every participant in the network stores the entire blockchain (and thus all of its history) since we don’t utilize a centralized server.</li>
<li>new transaction, is broadcast to everyone, and verified by all. If the transaction is correct, everyone will append it to their local blockchain.</li>
<li>assumption - majority of the users are honest (more than half)</li>
</ul>
</li>
<li>Consensus via proof of work
<ul>
<li><em>miners</em> - can only add a block if they have a valid proof of work</li>
<li>a computational puzzle that takes the hash of the current block concatenated with a random number. This random number can be incremented so that the hash changes, until the proof of work is solved.</li>
<li>Miners then broadcast blocks with their proof of work. All honest miners listen for such blocks, check the blocks for correctness, and <em>accept the longest correct chain</em>.</li>
<li>By always accepting the longest blockchain, all the miners are ensured to have the same blockchain view.</li>
</ul>
</li>
<li>Sybil attack
<ul>
<li>small number of users counterfeiting multiple peer identities so as to compromise a disproportionate share of the system.</li>
<li>Majority is defined by computational power.</li>
</ul>
</li>
</ul>
<h2 id="network-security" class="headerLink">
    <a href="#network-security" class="header-mark"></a>Network Security</h2><h3 id="introduction-to-networking" class="headerLink">
    <a href="#introduction-to-networking" class="header-mark"></a>Introduction to Networking</h3><ul>
<li>A group of local machines forms a <strong>local area network (LAN)</strong>.
<ul>
<li>all machines are connected to all other machines</li>
</ul>
</li>
<li>A <strong>router</strong> is used to connect multiple LANs.</li>
<li><strong>wide area network</strong> forms the basis of the Internet.</li>
<li>Layers
<ul>
<li>Layer 1: Communication of bits</li>
<li>Layer 2: Local frame delivery
<ul>
<li>Ethernet: The most common Layer 2 protocol</li>
<li>MAC addresses: 6-byte addressing system used by Ethernet</li>
</ul>
</li>
<li>Layer 3: Global packet delivery
<ul>
<li>IP: The universal Layer 3 protocol</li>
<li>IP addresses: 4-byte (32 bit) addressing system used by IP</li>
</ul>
</li>
<li>Layer 4: Transport of data</li>
<li>Layer 7: Applications and services (the web)</li>
<li><img class="tw-inline" loading="lazy" src='https://i.imgur.com/FWpM6wH.png'     ></li>
<li>Each layer has its own set of <strong>protocols</strong>
<ul>
<li>To support protocols, messages are sent with a <strong>header</strong></li>
</ul>
</li>
<li>Each layer adds its own header to the top of the message provided from the layer directly above.</li>
<li>When the <em>message reaches the lowest layer from the top</em>, it now has multiple headers, starting with the header for the lowest layer first.</li>
<li><em>At destination, starting at the lowest layer</em>, the message moves up the protocol stack to higher layers. Each layer removes its header and provides the remaining content to the layer directly above. When the message reaches the highest layer, all headers have been processed, and the recipient sees the regular human-readable text from before.</li>
</ul>
</li>
<li>Layer 2 (link layer) uses 48-bit (6-byte) <strong>MAC addresses</strong> to uniquely identify each machine on the LAN.
<ul>
<li>written as 6 pairs of hex numbers</li>
<li>the broadcast address of <code>ff:ff:ff:ff:ff:ff</code></li>
<li>CSMA/CD protocol - carrier sense multiple access collision detection</li>
</ul>
</li>
<li>Layer 3 (IP layer) uses 32-bit (4-byte) <strong>IP addresses</strong>
<ul>
<li>IPv6, uses 128-bit IP addresses, which are written as 8 2-byte hex values separated by colons, such as <code>cafe:f00d:d00d:1401:2414:1248:1281:8712</code></li>
</ul>
</li>
<li>higher layers (transport layer) assign each process on a machine a unique 16-bit <strong>port number</strong>
<ul>
<li>web servers HTTP requests - port 80</li>
<li>HTTPS - port 443.</li>
<li>Ports below 1024 - &ldquo;reserved&rdquo;</li>
</ul>
</li>
<li>At the lower layers, we call individual messages <strong>packets</strong>. Packets are usually limited to a fixed length.</li>
<li>The IP (Internet Protocol) at layer 3 only guarantees <em>best-effort delivery</em>, and does not handle any errors. Instead, we rely on higher layers for correctness and security.</li>
<li>Adversaries
<ul>
<li><strong>Off-path Adversary:</strong> The off-path adversary cannot read or modify any messages over the connection.</li>
<li><strong>On-path Adversary:</strong> The on-path adversary can read, but not modify messages.</li>
<li><strong>In-path Adversary:</strong> The in-path (man-in-the-middle) adversary has all the powers of the on-path adversary and can additionally modify and block messages sent by either party.</li>
</ul>
</li>
</ul>
<h3 id="arp" class="headerLink">
    <a href="#arp" class="header-mark"></a>ARP</h3><ul>
<li><strong>Layer</strong>: Link (2)</li>
<li><strong>Purpose</strong>: Translate IP addresses to MAC addresses</li>
<li><strong>Vulnerability</strong>: On-path attackers can see requests and send spoofed malicious responses</li>
<li><strong>Defense</strong>: Switches, <code>arpwatch</code></li>
<li><strong>ARP</strong>, the <strong>Address Resolution Protocol</strong>, translates Layer 3 IP addresses into Layer 2 MAC addresses. ARP replies are always cached</li>
<li>three steps:
<ol>
<li>Alice would broadcast to everyone else on the LAN: &ldquo;What is the MAC address of <code>1.1.1.1</code>?&rdquo;</li>
<li>Bob responds by sending a message only to Alice: &ldquo;My IP is <code>1.1.1.1</code> and my MAC address is <code>ca:fe:f0:0d:be:ef</code>.&rdquo; Everyone else does nothing.</li>
<li>Alice caches the IP address to MAC address mapping for Bob.</li>
</ol>
</li>
<li><strong>ARP Spoofing</strong>:
<ul>
<li>no way to verify that the reply in step 2 is actually from Bob</li>
<li>Mallory is able to create a spoofed reply and send it to Alice before Bob can send his legitimate reply</li>
<li>Defense:
<ul>
<li><code>arpwatch</code> - tracks the IP address to MAC address pairings across the LAN and makes sure nothing suspicious happens.</li>
<li>Switches: VLAN</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="wpa" class="headerLink">
    <a href="#wpa" class="header-mark"></a>WPA</h3><ul>
<li><strong>WPA2-PSK (WiFi Protected Access: Pre-Shared Key)</strong> is a protocol that enables secure communications over a WiFi network by encrypting messages with cryptography.</li>
<li><strong>Layer</strong>: Link (2)</li>
<li><strong>Purpose</strong>: Communicate securely in a wireless local network</li>
<li><strong>Vulnerability</strong>: On-path attackers can learn the encryption keys from the handshake and decrypt messages (includes brute-forcing the password if they don’t know it already)</li>
<li><strong>Defense</strong>: WPA2-Enterprise
<ul>
<li>WPA2-Enterprise gives authorized users a unique username and password</li>
<li>the authentication server presents both the client and the access point with a random <strong>PMK (Pairwise Master Key)</strong> to use instead of the PSK</li>
</ul>
</li>
<li><img class="tw-inline" loading="lazy" src='https://textbook.cs161.org/assets/images/network/wpa/wpa2.png'     ></li>
<li>all further communication between the client and the access point is encrypted with the <strong>PTK</strong></li>
<li>The GTK is used for messages broadcast to the entire network (i.e. sent to the broadcast MAC address, <code>ff:ff:ff:ff:ff:ff</code>). The GTK is the same for everyone on the network, so everyone can encrypt/send and decrypt/receive broadcast messages.</li>
<li>In practice, the handshake is <strong>optimized into a 4-way handshake</strong>, requiring only 4 messages to be exchanged between the client and the access point.</li>
</ul>
<h3 id="dhcp" class="headerLink">
    <a href="#dhcp" class="header-mark"></a>DHCP</h3><ul>
<li><strong>DHCP</strong> (<strong>Dynamic Host Configuration Protocol</strong>) is responsible for setting up configurations when a computer first joins a local network</li>
<li>Steps:
<ol>
<li><strong>Client Discover</strong>: The client broadcasts a request for a configuration.</li>
<li><strong>Server Offer</strong>: Any server able to offer IP addresses responds with some configuration settings. (In practice, usually only one server replies here.)</li>
<li><strong>Client Request</strong>: The client broadcasts which configuration it has chosen.</li>
<li><strong>Server Acknowledge</strong>: The chosen server confirms that its configuration has been chosen.</li>
</ol>
</li>
<li><strong>Vulnerability</strong>: On-path attackers can see requests and send spoofed malicious responses</li>
<li><strong>Defense</strong>: Accept as a fact of life and rely on higher layers</li>
</ul>
<h3 id="bgp" class="headerLink">
    <a href="#bgp" class="header-mark"></a>BGP</h3><ul>
<li><strong>Layer</strong>: 3 (inter-network)</li>
<li><strong>Purpose</strong>: Send messages globally by connecting lots of local networks</li>
<li><strong>Vulnerability</strong>: Malicious local networks can read messages in intermediate transit and forward them to the wrong place</li>
<li><strong>Defense</strong>: Accept as a fact of life and rely on higher layers</li>
</ul>
<h3 id="tcp-and-udp" class="headerLink">
    <a href="#tcp-and-udp" class="header-mark"></a>TCP and UDP</h3><ul>
<li>The UDP and TCP header contains 16-bit source and destination port numbers to support communication between processes. The header also contains a checksum (non-cryptographic) to detect corrupted packets. Both <em>protocols are stateless</em>.</li>
<li>TCP connection is identified by a 5-tuple of <code>(Client IP Address, Client Port, Server IP Address, Server Port, Protocol=TCP)</code>.
<ul>
<li><strong>No Confidentiality or Integrity</strong> by itself</li>
</ul>
</li>
</ul>

<div class="table-wrapper">
  <table>
    <thead>
        <tr>
            <th style="text-align: left">Sequence number (SYN)</th>
            <th style="text-align: left">Acknowldgement number (ACK)</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="text-align: left">32 bit</td>
            <td style="text-align: left">32 bit</td>
        </tr>
        <tr>
            <td style="text-align: left">index of the first byte sent</td>
            <td style="text-align: left">index of the last byte received, plus 1. Ex: in packets from the client to the server, the ACK number is the next unsent byte in the server-to-client stream, and in packets from the server to the client, the ACK number is the next unsent byte in the client-to-server stream</td>
        </tr>
        <tr>
            <td style="text-align: left">reconstruct the message in the correct order</td>
            <td style="text-align: left">after a timeout period, the sender will re-send that packet</td>
        </tr>
        <tr>
            <td style="text-align: left"></td>
            <td style="text-align: left">Each TCP packet can contain both data and an acknowledgment that a previous packet was received</td>
        </tr>
    </tbody>
  </table>
</div>
<ul>
<li>To end a connection, one side sends a FIN (a packet with the FIN flag set), and the other side replies with a FIN-ACK.</li>
<li>Side that sent the FIN will not send any more data, but can continue accepting data.</li>
<li>RST packet
<ul>
<li>unilateral abortion</li>
<li>no more packets accepted or sent</li>
<li>no acknowledgment</li>
</ul>
</li>
<li><strong>Attacks</strong>
<ul>
<li>RST injection: abruptly end connection</li>
<li>Different network attackers attack differently
<ul>
<li>Off path - needs to guess initial sequence number</li>
<li>On path - needs to race an own packet against sender to receiver</li>
<li>In path - can block, modify, do anything without racing</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="tls" class="headerLink">
    <a href="#tls" class="header-mark"></a>TLS</h3><ul>
<li><strong>TLS</strong> (<strong>Transport Layer Security</strong>) is a protocol that provides an end-to-end encrypted communication channel. (SSL - old version)</li>
<li>End-to-end encryption - no person other than sender and receiver can read or modify data.</li>
<li><strong>layer 6.5</strong> protocol</li>
<li>Uses the underlying TCP.</li>
<li>Client sends $R_B$ and a list of encryption protocols it supports.</li>
<li>Server responds with $R_S$ and the certificate signed by CA</li>
<li>Next is to generate a <strong>premature secret (PS)</strong>
<ul>
<li>generate random and encrypt with RSA</li>
<li>Or, use Diffie Hellman</li>
</ul>
</li>
<li>Generating the PS with DHE and ECDHE (elliptic curve DHE) has a substantial advantage over RSA key exchange, because it provides <strong>forward secrecy</strong>
<ul>
<li>Suppose an attacker records lots of RSA-based TLS communications, and some time in the future manages to steal the server’s private key. Now the attacker can decrypt PS values sent in old connections, which violates the security of those old TLS connections.</li>
</ul>
</li>
<li>Use the PS and the random values $R_B$ and $R_S$ to derive a set of four shared symmetric keys: an <em>encryption key $C_B$ and an integrity key $I_B$ for the client, and an encryption key $C_S$ and an integrity key $I_S$ for the server</em>.</li>
<li>client and server exchange and verify MACs over all messages sent so far
<ul>
<li>$I_B$ and $I_S$ are known to both the client and server so that they can verify.</li>
</ul>
</li>
<li>Security against replay attacks:
<ul>
<li>For a connection: due to randomly generated $R_B$ and $R_S$.</li>
<li>For the same connection: counter or timestamp so that an attacker cannot record a TLS message and send it again within the same connection.</li>
</ul>
</li>
</ul>
<h3 id="dns" class="headerLink">
    <a href="#dns" class="header-mark"></a>DNS</h3><ul>
<li>A DNS query for <code>eecs.berkeley.edu</code> <img class="tw-inline" loading="lazy" src='https://textbook.cs161.org/assets/images/network/dns/dnsquery.png'     >
<ul>
<li><em>uses UDP</em></li>
<li>13 root servers</li>
</ul>
</li>
<li>Each <strong>name server</strong> is only responsible for storing information about their children, except for the name servers at the bottom of the tree, which are responsible for storing the actual mappings from domain names to IP addresses.</li>
<li>A <strong>DNS Recursive Resolver</strong> provided by your Internet service provider (ISP), which sends the queries, processes the responses, and maintains an internal cache of records. When performing a lookup, the <strong>DNS Stub Resolver</strong> on your computer sends a query to the recursive resolver, lets it do all the work, and receives the response.</li>
</ul>

<div class="table-wrapper">
  <table>
    <thead>
        <tr>
            <th style="text-align: ">16 bits</th>
            <th style="text-align: ">16 bits</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="text-align: ">Identification (used to match requests to responses)</td>
            <td style="text-align: ">Flags (<code>NOERROR</code>, <code>NXDOMAIN</code>)</td>
        </tr>
        <tr>
            <td style="text-align: "># Questions (=1)</td>
            <td style="text-align: "># Answer RRs (Resource records)</td>
        </tr>
        <tr>
            <td style="text-align: "># Authority RRs</td>
            <td style="text-align: "># Additional RRs</td>
        </tr>
        <tr>
            <td style="text-align: ">Questions (variable # of RRs)</td>
            <td style="text-align: "></td>
        </tr>
        <tr>
            <td style="text-align: ">Answers (variable # of RRs)</td>
            <td style="text-align: "></td>
        </tr>
        <tr>
            <td style="text-align: ">Authority (variable # of RRs)</td>
            <td style="text-align: "></td>
        </tr>
        <tr>
            <td style="text-align: ">Additional info (variable # of RRs)</td>
            <td style="text-align: "></td>
        </tr>
    </tbody>
  </table>
</div>
<ul>
<li>A DNS record key is formally defined as a 3-tuple <code>&lt;Name, Class, Type&gt;</code></li>
<li>A DNS record value contains <code>&lt;TTL, Value&gt;</code>
<ul>
<li><strong>A type records</strong> map domains to IP addresses (<code>AAAA</code> for IPv6)</li>
<li><strong>NS type records</strong> map zones to domains</li>
<li>number of additional records is always 1 more than the actual number of additional records that appear in the response (extra record corresponds to the <code>OPT</code> pseudosection)</li>
</ul>
</li>
</ul>
<div class="code-block highlight is-open show-line-numbers  tw-group tw-my-2">
  <div class="
    code-block-title 
    
    tw-flex 
    tw-flex-row 
    tw-justify-between 
    tw-w-full tw-bg-bgColor-secondary
    ">      
    <button 
      class="
        tw-select-none 
        tw-mx-2 
        tw-block
        group-[.is-open]:tw-rotate-90
        tw-transition-[transform] 
        tw-duration-500 
        tw-ease-in-out
        print:!tw-hidden"
      disabled
      aria-hidden="true"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg></button>

    <div class="code-block-title-bar tw-w-full">
      <p class="tw-select-none !tw-my-1">shell</p>
    </div>
    <div class="tw-flex">
      <button 
        class="
          line-number-button
          tw-select-none 
          tw-mx-2 
          tw-hidden 
          group-[.is-open]:tw-block 
          group-[.show-line-numbers]:tw-text-fgColor-link 
          print:!tw-hidden" 
        title="Toggle line numbers"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M61.77 401l17.5-20.15a19.92 19.92 0 0 0 5.07-14.19v-3.31C84.34 356 80.5 352 73 352H16a8 8 0 0 0-8 8v16a8 8 0 0 0 8 8h22.83a157.41 157.41 0 0 0-11 12.31l-5.61 7c-4 5.07-5.25 10.13-2.8 14.88l1.05 1.93c3 5.76 6.29 7.88 12.25 7.88h4.73c10.33 0 15.94 2.44 15.94 9.09 0 4.72-4.2 8.22-14.36 8.22a41.54 41.54 0 0 1-15.47-3.12c-6.49-3.88-11.74-3.5-15.6 3.12l-5.59 9.31c-3.72 6.13-3.19 11.72 2.63 15.94 7.71 4.69 20.38 9.44 37 9.44 34.16 0 48.5-22.75 48.5-44.12-.03-14.38-9.12-29.76-28.73-34.88zM496 224H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-160H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 320H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zM16 160h64a8 8 0 0 0 8-8v-16a8 8 0 0 0-8-8H64V40a8 8 0 0 0-8-8H32a8 8 0 0 0-7.14 4.42l-8 16A8 8 0 0 0 24 64h8v64H16a8 8 0 0 0-8 8v16a8 8 0 0 0 8 8zm-3.91 160H80a8 8 0 0 0 8-8v-16a8 8 0 0 0-8-8H41.32c3.29-10.29 48.34-18.68 48.34-56.44 0-29.06-25-39.56-44.47-39.56-21.36 0-33.8 10-40.46 18.75-4.37 5.59-3 10.84 2.8 15.37l8.58 6.88c5.61 4.56 11 2.47 16.12-2.44a13.44 13.44 0 0 1 9.46-3.84c3.33 0 9.28 1.56 9.28 8.75C51 248.19 0 257.31 0 304.59v4C0 316 5.08 320 12.09 320z"/></svg></button>

      <button 
        class="
          wrap-code-button
          tw-select-none 
          tw-mx-2 
          tw-hidden 
          group-[.is-open]:tw-block 
          group-[.is-wrap]:tw-text-fgColor-link 
          print:!tw-hidden" 
        title="Toggle code wrap"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"/></svg></button>
      
      <button 
        class="
          copy-code-button
          tw-select-none
          tw-mx-2 
          tw-hidden
          group-[.is-open]:tw-block
          hover:tw-text-fgColor-link 
          print:!tw-hidden"
        title="Copy code">
          <span class="copy-icon tw-block"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"/></svg></span>
          <span class="check-icon tw-hidden"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"/></svg></span>
      </button>
        
      <button 
        class="
          tw-select-none 
          tw-mx-2 
          tw-block 
          group-[.is-open]:tw-hidden 
          print:!tw-hidden" 
        disabled
        aria-hidden="true"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M328 256c0 39.8-32.2 72-72 72s-72-32.2-72-72 32.2-72 72-72 72 32.2 72 72zm104-72c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72zm-352 0c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72z"/></svg></button>
    </div>
  </div>
  <pre style="counter-reset: codeblock;" class="tw-block tw-m-0 tw-p-0"><code 
    id="codeblock-id-1" 
    class="
      chroma 
      !tw-block 
      tw-p-0
      tw-m-0
      tw-transition-[max-height] 
      tw-duration-500 
      tw-ease-in-out 
      group-[.is-closed]:!tw-max-h-0 
      group-[.is-wrap]:tw-text-wrap
      tw-overflow-y-hidden
      tw-overflow-x-auto
      tw-scrollbar-thin
      "><span class="line"><span class="cl">$ dig +norecurse eecs.berkeley.edu @128.32.136.3
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">;;</span> Got answer:
</span></span><span class="line"><span class="cl"><span class="p">;;</span> -&gt;&gt;HEADER<span class="s">&lt;&lt;- opco</span>de: QUERY, status: NOERROR, id: <span class="m">52788</span>
</span></span><span class="line"><span class="cl"><span class="p">;;</span> flags: qr aa<span class="p">;</span> QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: <span class="m">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">;;</span> QUESTION SECTION:
</span></span><span class="line"><span class="cl"><span class="p">;</span>eecs.berkeley.edu.         IN   A
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">;;</span> ANSWER SECTION:
</span></span><span class="line"><span class="cl">eecs.berkeley.edu.  <span class="m">86400</span>   IN   A   23.185.0.1</span></span></code></pre>
</div>
<ul>
<li>With <strong>bailiwick checking</strong>, a name server is only allowed to provide records in its zone. (Ex. a <code>.com</code> NS can&rsquo;t provide for <code>.edu</code>)</li>
<li>The Kaminsky attack relies on querying for nonexistent domains.
<ul>
<li>include malicious additional records in the fake DNS response and make the victim query nonexistent domains.</li>
<li>There is no way to completely eliminate the Kaminsky attack in regular DNS, although modern DNS protocols add <strong>UDP source port randomization</strong> to make it much harder. (This doesn&rsquo;t stop On path attackers)</li>
</ul>
</li>
</ul>
<h3 id="dnssec" class="headerLink">
    <a href="#dnssec" class="header-mark"></a>DNSSEC</h3><ul>
<li><strong>DNSSEC</strong> is an extension to regular DNS that provides <em>integrity</em> and <em>authentication</em> on all DNS messages sent</li>
<li>Issue: What if name server is malicious?
<ul>
<li>Have a trust anchor: The root servers</li>
<li>Each name server will sign the public key of all its trusted children name servers, starting from the root</li>
</ul>
</li>
<li>The <strong><code>DNSKEY</code> type record</strong> encodes a public key.</li>
<li>The <strong><code>RRSIG</code> type record</strong> is a signature on a set of multiple other records in the message, all of the same type.</li>
<li>The <strong><code>DS</code> (Delegated Signer) type record</strong> is a hash of the signer’s name and a child’s public key.</li>
</ul>

<div class="table-wrapper">
  <table>
    <thead>
        <tr>
            <th style="text-align: left">KSK (Key Signing Key)</th>
            <th style="text-align: left">ZSK (Zone Signing Key)</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="text-align: left">used to sign ZSK</td>
            <td style="text-align: left">used to sign everything else</td>
        </tr>
        <tr>
            <td style="text-align: left">endorsed by the parent</td>
            <td style="text-align: left">resolver verifies by using public ZSK</td>
        </tr>
    </tbody>
  </table>
</div>
<ul>
<li>DNSSEC sign records <em>offline</em>–records</li>
<li>In case of nonexistent records, name servers pre-compute signatures on <em>ranges</em> of nonexistent domains.
<ul>
<li><strong>NSEC record</strong> - no domains exist between domains.
<ul>
<li><code>NSEC3</code>, <code>NSEC5</code> - newer versions, uses hash instead of domain names</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="dos" class="headerLink">
    <a href="#dos" class="header-mark"></a>DoS</h3><ul>
<li>Any attack that is designed to cause a machine or a piece of software to be unavailable and unable to perform its basic functionality is known as a <strong>denial of service (DoS) attack</strong>.</li>
<li>Attackers can generate a unique source IP address for every packet sent, thus preventing the target from successfully identifying and blocking the attacker.</li>
<li>Application level
<ul>
<li>exhausting the RAM by having continuous calls to <code>malloc</code></li>
<li>exhausting the processing threads by having continuous calls to <code>fork</code></li>
<li>exhausting the disk I/O operations</li>
<li><em>Prevention</em>: Identification, Isolation, Quotas (proof-of-work : like a <em>CAPTCHA</em>)</li>
</ul>
</li>
<li>In a <strong>SYN flooding attack</strong>
<ul>
<li>send a large number of SYN packets to the server</li>
<li>ignore the SYN/ACK replies</li>
<li>never send the ACK response</li>
<li>mitigation: <em>SYN cookies</em> - Only when the handshake is complete will the server allocate state for the connection after checking the cookie against the secret.</li>
</ul>
</li>
<li>Often, attackers carry out <em>DDoS attacks by using botnets</em>, a series of large networks of machines that have been compromised and are controllable remotely.
<ul>
<li><em>no way to completely eliminate</em></li>
</ul>
</li>
</ul>
<h3 id="firewall" class="headerLink">
    <a href="#firewall" class="header-mark"></a>Firewall</h3><ul>
<li><em>Turn off every unnecessary network service</em></li>
<li>Firewalls reduce risk by blocking network outsiders from having unwanted access to all the network services by acting as a choke point between the internet (outsiders) and your internal network.</li>
<li>An <em>inbound connection</em> is one that is <em>initiated by external users</em> and attempts to connect to services that are running on internal machines.</li>
<li>an <em>outbound connection</em> is one which is <em>initiated by an internal user</em>, and attempts to initiate contact with external services.</li>
<li>Security policy: A kind of access control policy
<ul>
<li>Subjects - computers</li>
<li>Objects - network services</li>
<li>Policy - whether that subject has permission to access that object</li>
<li>Two ways
<ul>
<li><em>Default-allow or blacklist</em>: By default, every network service is permitted unless it has been specifically listed as denied.</li>
<li><em>Default-deny or whitelist</em>: By default, every network service is denied to external users, unless it has been specifically listed as allowed. <strong>Much safer bet</strong></li>
</ul>
</li>
</ul>
</li>
<li>we can identify each network service with a triplet $(m,r,p)$
<ul>
<li>$m$ - IP address of a machine</li>
<li>$r$ - protocol identifier (i.e. TCP or UDP)</li>
<li>$p$ - port number</li>
<li>An allow list would include triplets. Ex. <code>(1.2.3.4, TCP, 80)</code></li>
</ul>
</li>
</ul>
<div class="code-block highlight is-open show-line-numbers  tw-group tw-my-2">
  <div class="
    code-block-title 
    
    tw-flex 
    tw-flex-row 
    tw-justify-between 
    tw-w-full tw-bg-bgColor-secondary
    ">      
    <button 
      class="
        tw-select-none 
        tw-mx-2 
        tw-block
        group-[.is-open]:tw-rotate-90
        tw-transition-[transform] 
        tw-duration-500 
        tw-ease-in-out
        print:!tw-hidden"
      disabled
      aria-hidden="true"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg></button>

    <div class="code-block-title-bar tw-w-full">
      <p class="tw-select-none !tw-my-1">shell</p>
    </div>
    <div class="tw-flex">
      <button 
        class="
          line-number-button
          tw-select-none 
          tw-mx-2 
          tw-hidden 
          group-[.is-open]:tw-block 
          group-[.show-line-numbers]:tw-text-fgColor-link 
          print:!tw-hidden" 
        title="Toggle line numbers"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M61.77 401l17.5-20.15a19.92 19.92 0 0 0 5.07-14.19v-3.31C84.34 356 80.5 352 73 352H16a8 8 0 0 0-8 8v16a8 8 0 0 0 8 8h22.83a157.41 157.41 0 0 0-11 12.31l-5.61 7c-4 5.07-5.25 10.13-2.8 14.88l1.05 1.93c3 5.76 6.29 7.88 12.25 7.88h4.73c10.33 0 15.94 2.44 15.94 9.09 0 4.72-4.2 8.22-14.36 8.22a41.54 41.54 0 0 1-15.47-3.12c-6.49-3.88-11.74-3.5-15.6 3.12l-5.59 9.31c-3.72 6.13-3.19 11.72 2.63 15.94 7.71 4.69 20.38 9.44 37 9.44 34.16 0 48.5-22.75 48.5-44.12-.03-14.38-9.12-29.76-28.73-34.88zM496 224H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-160H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 320H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zM16 160h64a8 8 0 0 0 8-8v-16a8 8 0 0 0-8-8H64V40a8 8 0 0 0-8-8H32a8 8 0 0 0-7.14 4.42l-8 16A8 8 0 0 0 24 64h8v64H16a8 8 0 0 0-8 8v16a8 8 0 0 0 8 8zm-3.91 160H80a8 8 0 0 0 8-8v-16a8 8 0 0 0-8-8H41.32c3.29-10.29 48.34-18.68 48.34-56.44 0-29.06-25-39.56-44.47-39.56-21.36 0-33.8 10-40.46 18.75-4.37 5.59-3 10.84 2.8 15.37l8.58 6.88c5.61 4.56 11 2.47 16.12-2.44a13.44 13.44 0 0 1 9.46-3.84c3.33 0 9.28 1.56 9.28 8.75C51 248.19 0 257.31 0 304.59v4C0 316 5.08 320 12.09 320z"/></svg></button>

      <button 
        class="
          wrap-code-button
          tw-select-none 
          tw-mx-2 
          tw-hidden 
          group-[.is-open]:tw-block 
          group-[.is-wrap]:tw-text-fgColor-link 
          print:!tw-hidden" 
        title="Toggle code wrap"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"/></svg></button>
      
      <button 
        class="
          copy-code-button
          tw-select-none
          tw-mx-2 
          tw-hidden
          group-[.is-open]:tw-block
          hover:tw-text-fgColor-link 
          print:!tw-hidden"
        title="Copy code">
          <span class="copy-icon tw-block"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"/></svg></span>
          <span class="check-icon tw-hidden"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"/></svg></span>
      </button>
        
      <button 
        class="
          tw-select-none 
          tw-mx-2 
          tw-block 
          group-[.is-open]:tw-hidden 
          print:!tw-hidden" 
        disabled
        aria-hidden="true"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M328 256c0 39.8-32.2 72-72 72s-72-32.2-72-72 32.2-72 72-72 72 32.2 72 72zm104-72c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72zm-352 0c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72z"/></svg></button>
    </div>
  </div>
  <pre style="counter-reset: codeblock;" class="tw-block tw-m-0 tw-p-0"><code 
    id="codeblock-id-2" 
    class="
      chroma 
      !tw-block 
      tw-p-0
      tw-m-0
      tw-transition-[max-height] 
      tw-duration-500 
      tw-ease-in-out 
      group-[.is-closed]:!tw-max-h-0 
      group-[.is-wrap]:tw-text-wrap
      tw-overflow-y-hidden
      tw-overflow-x-auto
      tw-scrollbar-thin
      "><span class="line"><span class="cl">allow tcp ∗:∗ → 1.2.3.4:25
</span></span><span class="line"><span class="cl">drop ∗ ∗:∗ → ∗:∗</span></span></code></pre>
</div>
<ul>
<li>A stateful packet filter maintains state, meaning that it keeps track of all open connections that have been established.</li>
<li><em>Application-layer firewalls</em> restrict traffic according to the content of the data fields. These types of firewalls have certain <em>security advantages</em> since they can enforce <em>more restrictive security policies</em> and can transform data on the fly.
<ul>
<li>Ex. Proxy servers. all traffic goes through them.</li>
</ul>
</li>
<li>Firewalls also embody <em>orthogonal security</em> meaning that it can be deployed to protect pre-existing legacy systems much more easily than other security mechanisms that have to be integrated with the rest of the system.</li>
</ul>
<h3 id="ip-security" class="headerLink">
    <a href="#ip-security" class="header-mark"></a>IP security</h3><ul>
<li>IP spoofing countermeasures
<ul>
<li>TCP handles it with sequence numbers.</li>
<li>Ingress filtering - block outside network packets having inside network address.</li>
<li>Egress filtering - block outgoing packets with non matching destination network addresses.</li>
</ul>
</li>
<li><strong>ICMP</strong> - internet control message protocol
<ul>
<li>helps IP in error reporting</li>
<li>simple queries (<code>ping</code>)</li>
</ul>
</li>
<li>IPSec
<ul>
<li>layer 3.5</li>
<li>CIA in this layer.</li>
<li>modifications in OS</li>
<li>connection oriented i.e has state (contrary to IP)</li>
</ul>
</li>
<li>IP packet can be changed in a MITM attack as routers have access to the packet.</li>
<li>If IP security is handled, then all layers above are secure.</li>
<li>use cases - VPNs</li>
<li>Send packets by Symmetric key encryption.</li>
<li>SA (security association) = SPI + Destination IP + IPSec (ESP pr AH)</li>
<li>SPD (security policy database) - used to map outgoing packet to a particular SA</li>
<li><strong>ESP</strong>
<ul>
<li>Provides source authentication, data integrity and confidentiality</li>
<li><em>transport mode</em> - end to end hosts <img class="tw-inline" loading="lazy" src='https://i.imgur.com/Hw5ptcz.png'     >
<ul>
<li>original IP header is visible</li>
</ul>
</li>
<li><em>tunnel mode</em> (uses gateway) <img class="tw-inline" loading="lazy" src='https://i.imgur.com/VC56oqt.png'     >
<ul>
<li>default IPSec mode</li>
<li>protects the payload and IP header of original packet</li>
<li>authentication is applied to data in ESP header and data in payload.</li>
<li>process
<ul>
<li>verify sequence number, verify integrity and decrypt</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><strong>IKE (internet key exchange)</strong>
<ul>
<li>for establishing a shared secret for IPSec (SA)</li>
<li>bidirectional, contrary to the unidirectional SA</li>
</ul>
</li>
</ul></div>

        

<div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 24-05-2023</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line print:!tw-hidden">
            <div class="post-info-md"><span><a class="link-to-mardown" href=/cs161_computer_security_notes/index.md target="_blank" rel="noopener noreferrer">Read markdown</a>
                    </span></div>
            <div class="post-info-share"><button title="Share on Twitter" data-sharer="twitter" data-url="https://cs-mshah.github.io/cs161_computer_security_notes/" data-title="Notes from CS161: Computer Security" data-via="cs_mshah" data-hashtags="notes"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></button><button title="Share on Facebook" data-sharer="facebook" data-url="https://cs-mshah.github.io/cs161_computer_security_notes/" data-hashtag="notes"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg></button><button title="Share on Linkedin" data-sharer="linkedin" data-url="https://cs-mshah.github.io/cs161_computer_security_notes/"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg></button><button title="Share on WhatsApp" data-sharer="whatsapp" data-url="https://cs-mshah.github.io/cs161_computer_security_notes/" data-title="Notes from CS161: Computer Security" data-web><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"/></svg></button><button title="Share on Hacker News" data-sharer="hackernews" data-url="https://cs-mshah.github.io/cs161_computer_security_notes/" data-title="Notes from CS161: Computer Security"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M0 32v448h448V32H0zm21.2 197.2H21c.1-.1.2-.3.3-.4 0 .1 0 .3-.1.4zm218 53.9V384h-31.4V281.3L128 128h37.3c52.5 98.3 49.2 101.2 59.3 125.6 12.3-27 5.8-24.4 60.6-125.6H320l-80.8 155.1z"/></svg></button><button title="Share on Telegram" data-sharer="telegram" data-url="https://cs-mshah.github.io/cs161_computer_security_notes/" data-title="Notes from CS161: Computer Security" data-web><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M446.7 98.6l-67.6 318.8c-5.1 22.5-18.4 28.1-37.3 17.5l-103-75.9-49.7 47.8c-5.5 5.5-10.1 10.1-20.7 10.1l7.4-104.9 190.9-172.5c8.3-7.4-1.8-11.5-12.9-4.1L117.8 284 16.2 252.2c-22.1-6.9-22.5-22.1 4.6-32.7L418.2 66.4c18.4-6.9 34.5 4.1 28.5 32.2z"/></svg></button></div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z"/></svg>&nbsp;<a href="/tags/notes/">Notes</a></section>
        <section class="print:!tw-hidden">
            <span><button class="tw-text-fgColor-link-muted hover:tw-text-fgColor-link-muted-hover" onclick="window.history.back();">Back</button></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav print:tw-hidden"><a href="/getting_started_with_cp/" class="prev" rel="prev" title="Getting started with competitive programming"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M31.7 239l136-136c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9L127.9 256l96.4 96.4c9.4 9.4 9.4 24.6 0 33.9L201.7 409c-9.4 9.4-24.6 9.4-33.9 0l-136-136c-9.5-9.4-9.5-24.6-.1-34z"/></svg>Getting started with competitive programming</a>
            <a href="/ncvpripg23_writer_verification/" class="next" rel="next" title="Winning the NCVPRIPG23 Challenge on Writer Verification">Winning the NCVPRIPG23 Challenge on Writer Verification<svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"/></svg></a></div>
</div>
<div id="comments" class="print:!tw-hidden tw-pt-32 tw-pb-8"><div id="utterances"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://utteranc.es/">Utterances</a>.
            </noscript></div></article></main><footer class="footer">
        <div class="footer-container"><div class="footer-line"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M256 8C119.033 8 8 119.033 8 256s111.033 248 248 248 248-111.033 248-248S392.967 8 256 8zm0 448c-110.532 0-200-89.451-200-200 0-110.531 89.451-200 200-200 110.532 0 200 89.451 200 200 0 110.532-89.451 200-200 200zm107.351-101.064c-9.614 9.712-45.53 41.396-104.065 41.396-82.43 0-140.484-61.425-140.484-141.567 0-79.152 60.275-139.401 139.762-139.401 55.531 0 88.738 26.62 97.593 34.779a11.965 11.965 0 0 1 1.936 15.322l-18.155 28.113c-3.841 5.95-11.966 7.282-17.499 2.921-8.595-6.776-31.814-22.538-61.708-22.538-48.303 0-77.916 35.33-77.916 80.082 0 41.589 26.888 83.692 78.277 83.692 32.657 0 56.843-19.039 65.726-27.225 5.27-4.857 13.596-4.039 17.82 1.738l19.865 27.17a11.947 11.947 0 0 1-1.152 15.518z"/></svg>2021 - 2025<span class="author">&nbsp;<a href="https://github.com/cs-mshah" target="_blank" rel="noopener noreferrer">Manan</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
            <div class="footer-line"></div>
            <div class="footer-line">
            </div>
        </div></footer><div class="print:!tw-hidden tw-flex tw-flex-col tw-fixed tw-right-4 tw-bottom-4 tw-gap-2"><a href="#back-to-top" id="back-to-top-button" class="tw-transition-opacity tw-opacity-0 tw-block tw-bg-bgColor-secondary tw-rounded-full" style="padding: 0.6rem; line-height: 1.3rem; font-size: 1rem;" title="Back to Top">
      <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6 0-33.9L207 39c9.4-9.4 24.6-9.4 33.9 0l194.3 194.3c9.4 9.4 9.4 24.6 0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3 0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z"/></svg>
  </a>

  <button id="toc-drawer-button" class="tw-block tw-bg-bgColor-secondary tw-rounded-full md:tw-hidden" style="padding: 0.6rem; line-height: 1.3rem; font-size: 1rem;">
      <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"/></svg>
  </button><a href="#comments" id="view-comments" class="tw-block tw-bg-bgColor-secondary tw-rounded-full" style="padding: 0.6rem; line-height: 1.3rem; font-size: 1rem;" title="View Comments">
      <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M256 32C114.6 32 0 125.1 0 240c0 49.6 21.4 95 57 130.7C44.5 421.1 2.7 466 2.2 466.5c-2.2 2.3-2.8 5.7-1.5 8.7S4.8 480 8 480c66.3 0 116-31.8 140.6-51.4 32.7 12.3 69 19.4 107.4 19.4 141.4 0 256-93.1 256-208S397.4 32 256 32z"/></svg>
  </a></div>
<link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/katex/copy-tex.min.css">
        <noscript><link rel="stylesheet" href="/lib/katex/copy-tex.min.css"></noscript>
<script>window.config={"autocomplete.min.js":"/lib/autocomplete/autocomplete.min.js","comment":{"utterances":{"darkTheme":"github-dark","issueTerm":"pathname","label":"","lightTheme":"github-light","repo":"cs-mshah/cs-mshah.github.io"}},"fuse.min.js":"/lib/fuse/fuse.min.js","math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"distance":100,"findAllMatches":false,"fuseIndexURL":"/index.json","highlightTag":"em","ignoreFieldNorm":false,"ignoreLocation":true,"isCaseSensitive":false,"location":0,"maxResultLength":10,"minMatchCharLength":2,"noResultsFound":"No results found","snippetLength":300,"threshold":0.1,"type":"fuse","useExtendedSearch":false},"sharerjs":true,"table":{"sort":true},"twemoji":true};</script><script
    src="/lib/tablesort/tablesort.min.js"
    
  ></script><script
    src="/lib/twemoji/twemoji.min.js"
    
      defer
    
  ></script><script
    src="/js/twemoji.min.js"
    
      defer
    
  ></script><script
    src="/lib/sharer/sharer.min.js"
    
  ></script><script
    src="/lib/katex/katex.min.js"
    
      defer
    
  ></script><script
    src="/lib/katex/auto-render.min.js"
    
      defer
    
  ></script><script
    src="/lib/katex/copy-tex.min.js"
    
      defer
    
  ></script><script
    src="/lib/katex/mhchem.min.js"
    
      defer
    
  ></script><script
    src="/js/katex.min.js"
    
      defer
    
  ></script><script
    src="/js/theme.min.js"
    
      defer
    
  ></script><script
    src="/js/utterances.min.js"
    
      defer
    
  ></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'G-BC120QQNGQ', { 'anonymize_ip': true });
        </script><script
    src="https://www.googletagmanager.com/gtag/js?id=G-BC120QQNGQ"
    async
  ></script><div class="assets">
    <script src="https://cdn.jsdelivr.net/gh/ncase/nutshell/nutshell.js"> </script>
    <script>
        Nutshell.setOptions({
            startOnLoad: true, 
            lang: 'en', 
            dontEmbedHeadings: true 
        });
    </script>
</div>

<script type="speculationrules">
  {
    "prerender": [
      {
        "where": { "href_matches": "/*" },
        "eagerness": "moderate"
      }
    ]
  }
</script>
</body>

</html>
